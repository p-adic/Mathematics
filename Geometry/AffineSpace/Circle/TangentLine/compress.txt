#ifdef DEBUG
  #include "c:/Users/user/Documents/Programming/Mathematics/Geometry/AffineSpace/Circle/TangentLine/a_Body.hpp"
#else
TE <TY INT> IN int sign(CO INT& n,CO INT& epsilon = 0){CE bool is_not_double = !is_same_v<INT,double>;AS(is_not_double || epsilon > 0);RE n < -epsilon?-1:epsilon < n?1:0;}

TE <TY INT> IN INT L22(CO INT& x,CO INT& y){RE x * x + y * y;}TE <TY INT,TE <TY...> TY PAIR> IN INT L22(CO PAIR<INT,INT>& v){RE L22(get<0>(v),get<1>(v));}TE <TY INT> IN INT L22_Distance(CO INT& x0,CO INT& y0,CO INT& x1,CO INT& y1){RE L22(x0 - x1,y0 - y1);}TE <TY INT,TE <TY...> TY PAIR> IN INT L22_Distance(CO PAIR<INT,INT>& v0,CO PAIR<INT,INT>& v1){RE L22(v0 - v1);}TE <TY INT> IN double L2(CO INT& x,CO INT& y){RE sqrt(L22(x,y));}TE <TY INT,TE <TY...> TY PAIR> IN double L2(CO PAIR<INT,INT>& v){RE sqrt(L22(v));}TE <TY INT> IN double L2_Distance(CO INT& x0,CO INT& y0,CO INT& x1,CO INT& y1){RE sqrt(L22_Distance(x0,y0,x1,y1));}TE <TY INT,TE <TY...> TY PAIR> IN double L2_Distance(CO PAIR<INT,INT>& v0,CO PAIR<INT,INT>& v1){RE sqrt(L22_Distance(v0,v1));}TE <TY INT> IN bool L2_LongestEdge(CO INT& x0,CO INT& y0,CO INT& x1,CO INT& y1,CO INT& z,CO INT& w,CO INT& epsilon){RE sign(L22_Distance(x0,y0,x1,y1)- max(L22_Distance(x0,y0,z,w),L22_Distance(z,w,x1,y1)),epsilon)>= 0;}TE <TY INT,TE <TY...> TY PAIR> IN bool L2_LongestEdge(CO PAIR<INT,INT>& v0,CO PAIR<INT,INT>& v1,CO PAIR<INT,INT>& v2,CO INT& epsilon = 0 ){RE L2_LongestEdge(get<0>(v0),get<1>(v0),get<0>(v1),get<1>(v1),get<0>(v2),get<1>(v2),epsilon);}

TE <TY PAIR,TY T> IN PAIR DivisionPoint(CO PAIR& p,CO PAIR& q,CO T& l,CO T& r){auto&[px,py]= p;auto&[qx,qy]= q;RE{(px * r + qx * l)/(l + r),(py * r + qy * l)/(l + r)};}

TE <TY T,TE <TY...> TY PAIR> IN T3<T> LineEquation(CO PAIR<T,T>& p,CO PAIR<T,T>& q){auto&[px,py]= p;auto&[qx,qy]= q;RE{py - qy,qx - px,px * qy - qx * py};}

TE <TY PAIR>VE<T3<double>> TangentLineFromPointToCircle(CO PAIR& point,CO PAIR& centre,CO double& radius){AS(radius > 0.0);CO PAIR v = centre - point;CO double D2 = L22(v),d = sqrt(D2 - radius * radius),D = sqrt(D2),c = d / D,s = radius / D;AS(c > 0.0);VE<T3<double>> AN(2);for(int i = 0;i < 2;i++){CO double t =(i == 0?s:-s)/ c;PAIR w{v[O]- t * v[I],t * v[O]+ v[I]};AN[i]= LineEquation(point,w += point);}RE AN;}TE <TY PAIR>VE<T3<double>> TangentLineFromCircleToCircle(CO PAIR& centre0,CO double& radius0,CO PAIR& centre1,CO double& radius1){auto p = DivisionPoint(centre0,centre1,radius0,radius1);auto AN = TangentLineFromPointToCircle(p,centre0,radius0);if(abs(radius0 - radius1)< 1e-8){auto&[c0x,c0y]= centre0;auto&[c1x,c1y]= centre1;double dx = c0y - c1y,dy = c1x - c0x,D = L2(dx,dy);dx /= D;dy /= D;for(int i = 0;i < 2;i++){CO int sign = i == 0?1:-1;CO PAIR q0{c0x + dx * radius0 * sign,c0y + dy * radius0 * sign},q1{c1x + dx * radius1 * sign,c1y + dy * radius1 * sign};AN.push_back(LineEquation(q0,q1));}}else{double r0 = radius0,r1 = radius1;(radius0 < radius1?r0:r1)*= -1;auto q = DivisionPoint(centre0,centre1,r0,r1);for(auto& v:TangentLineFromPointToCircle(q,centre0,radius0)){AN.push_back(MO(v));}}RE AN;}
#endif

