#ifdef DEBUG
  #include "c:/Users/user/Documents/Programming/Mathematics/Utility/String/Palindrome/Total/a_Body.hpp"
#else
TE <TY STR>VE<int> Manacher(CO STR& S){CO int N = S.SZ();VE<int> AN(N);int i = 0,l = 0,r = 0;WH(i < N){WH(0 <= l - 1 && r + 1 < N && S[l-1]== S[r+1]){l--;r++;}AN[i]= r - i;int l0 = i,r0 = i;WH(0 <= l0 - 1 && l < l0 - 1 - AN[l0-1]){l0--;r0++;AN[r0]= AN[l0];}i = r0 + 1;SetMax(r,i);l = i -(r - i);}RE AN;}

CL TotalPalindrome{PU:int m_N;VE<int> m_d;TE <TY STR> TotalPalindrome(CO STR& S);IN bool IsPalindrome(CRI l,CRI r)CO NE;IN ll count()CO NE;};
TE <TY STR>TotalPalindrome::TotalPalindrome(CO STR& S):m_N(S.SZ()),m_d(){if(m_N > 0){STR S_copy((m_N << 1)- 1,S[0]);for(int i = 1;i < m_N;i++){S_copy[i*2]= S[i];}m_d = Manacher(S_copy);}}IN bool TotalPalindrome::IsPalindrome(CRI l,CRI r)CO NE{AS(0 <= l && l <= r && r < m_N);RE r - l <= m_d[l+r];}IN ll TotalPalindrome::count()CO NE{ll AN = 0;for(int i = 0;i <(m_N << 1)- 1;i++){AN +=(m_d[i]+ 2 -(i & 1))>> 1;}RE AN;}
#endif

