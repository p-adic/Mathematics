# gcd(p,q),単位の分割u,v（p*u+q*v=gcd(p,q)）を返す。
def PartitionOfUnity(p,q):
	if q==0:return abs(p),1-2*(p<0),q
	g,c,d=PartitionOfUnity(q,p%q)
	return g,d,c-p//q*d

# gcd(p,q),非負最小解a（a≡s (mod p), a≡t (mod q)）を返す。
# ただし解がない場合はa=-1とする。
def ChineseRemainderTheorem(p,s,q,t):
	g,u,v=PartitionOfUnity(p,q)
	a=-1if s%g!=t%g else(s%g+t//g*p*u+s//g*q*v)%(p*q//g)
	return g,a
